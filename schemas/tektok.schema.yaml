$schema: "https://json-schema.org/draft/2020-12/schema"
title: "TEKTOK schema (YAML)"
type: object
required: [tektok]
properties:
  tektok:
    type: object
    required: [id, title, owner_org, domain, summary, links, evidence, net_value]
    properties:
      id: { type: string, minLength: 8 }
      title: { type: string }
      owner_org: { type: string }
      authors:
        type: array
        items: { type: object, properties: { name: { type: string }, id: { type: string } } }
      domain: { type: string }
      summary: { type: string }
      links:
        type: object
        required: [ce_id]
        properties:
          ce_id: { type: string }
          dm_refs: { type: array, items: { type: string } }
          repo_path: { type: string }
      effectivity:
        type: object
        properties: { aircraft_sn: { type: string }, config: { type: string }, mod_state: { type: string } }
      evidence:
        type: object
        required: [sha256]
        properties:
          det_uris: { type: array, items: { type: string } }
          sha256: { type: string, pattern: "^[a-fA-F0-9]{64}$" }
          cdtl_anchor:
            type: object
            properties:
              network: { type: string }
              tx_id: { type: string, pattern: "^0x[0-9a-fA-F]+$" }
              block_hash: { type: string, pattern: "^0x[0-9a-fA-F]+$" }
              height: { type: integer }
      net_value:
        type: object
        required: [inputs, weights, score]
        properties:
          inputs:
            type: object
            required: [trl, quality, energy_saving_pct, co2e_avoided_kg_per_unit, market_readiness, risk_discount]
            properties:
              trl: { type: integer, minimum: 1, maximum: 9 }
              quality: { type: number, minimum: 0, maximum: 1 }
              energy_saving_pct: { type: number, minimum: 0 }
              co2e_avoided_kg_per_unit: { type: number, minimum: 0 }
              market_readiness: { type: number, minimum: 0, maximum: 1 }
              risk_discount: { type: number, minimum: 0, maximum: 0.5 }
          weights:
            type: object
            properties: { trl: { type: number }, quality: { type: number }, energy: { type: number }, market: { type: number }, co2e: { type: number } }
          score: { type: number, minimum: 0, maximum: 1 }
      circularity:
        type: object
        properties:
          repairability: { type: number, minimum: 0, maximum: 1 }
          recycled_content_pct: { type: number, minimum: 0 }
          reuse_rate_pct: { type: number, minimum: 0 }
          greenscore: { type: number, minimum: 0, maximum: 1 }
    rights: { type: object, properties: { license: { type: string }, usage: { type: string } } }
    rie: { type: object, properties: { events: { type: array, items: { type: string } } } }
    date_issued: { type: string, format: 'date-time' }
    signature: { type: string }
