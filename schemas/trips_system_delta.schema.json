{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "TRIPS System Delta",
  "description": "Schema for System Delta Language (SΔL) structures in TRIPS",
  "type": "object",
  "required": ["delta_id", "from_version", "to_version", "timestamp", "operations"],
  "properties": {
    "delta_id": {
      "type": "string",
      "pattern": "^DELTA:[A-Z]{3}:v\\d+\\.\\d+:v\\d+\\.\\d+:[0-9a-f]{8}$",
      "description": "Unique delta identifier"
    },
    "from_version": {
      "type": "string",
      "pattern": "^v\\d+\\.\\d+$",
      "description": "Source version"
    },
    "to_version": {
      "type": "string",
      "pattern": "^v\\d+\\.\\d+$",
      "description": "Target version"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Delta generation timestamp"
    },
    "operations": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["operation", "level", "component", "magnitude", "risk", "impact", "reversible"],
        "properties": {
          "operation": {
            "type": "string",
            "enum": ["+", "-", "~", "↑", "↓", "!"],
            "description": "SDL operation type: + Added, - Removed, ~ Modified, ↑ Enhanced, ↓ Degraded, ! Critical"
          },
          "level": {
            "type": "string",
            "enum": ["Component", "Interface", "Requirement", "Performance", "Architecture"],
            "description": "Abstraction level of the change"
          },
          "component": {
            "type": "string",
            "description": "Component identifier or path"
          },
          "magnitude": {
            "type": "number",
            "minimum": 0,
            "maximum": 10,
            "description": "Change magnitude on 0-10 scale"
          },
          "risk": {
            "type": "string",
            "enum": ["Low", "Medium", "High"],
            "description": "Risk level assessment"
          },
          "impact": {
            "type": "string",
            "enum": ["Local", "System", "Global"],
            "description": "Scope of impact"
          },
          "reversible": {
            "type": "boolean",
            "description": "Whether the change can be reversed"
          },
          "description": {
            "type": "string",
            "description": "Human-readable description of the change"
          },
          "before": {
            "type": "object",
            "description": "State before the change"
          },
          "after": {
            "type": "object",
            "description": "State after the change"
          },
          "dependencies": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of dependent components"
          },
          "trace_refs": {
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^(REQ|TRACE):[A-Za-z0-9\\-]+$"
            },
            "description": "Related requirements and traces"
          }
        }
      }
    },
    "summary": {
      "type": "object",
      "properties": {
        "total_operations": {"type": "integer", "minimum": 0},
        "by_operation": {
          "type": "object",
          "properties": {
            "added": {"type": "integer", "minimum": 0},
            "removed": {"type": "integer", "minimum": 0},
            "modified": {"type": "integer", "minimum": 0},
            "enhanced": {"type": "integer", "minimum": 0},
            "degraded": {"type": "integer", "minimum": 0},
            "critical": {"type": "integer", "minimum": 0}
          }
        },
        "by_level": {
          "type": "object",
          "properties": {
            "component": {"type": "integer", "minimum": 0},
            "interface": {"type": "integer", "minimum": 0},
            "requirement": {"type": "integer", "minimum": 0},
            "performance": {"type": "integer", "minimum": 0},
            "architecture": {"type": "integer", "minimum": 0}
          }
        },
        "risk_distribution": {
          "type": "object",
          "properties": {
            "low": {"type": "integer", "minimum": 0},
            "medium": {"type": "integer", "minimum": 0},
            "high": {"type": "integer", "minimum": 0}
          }
        },
        "overall_magnitude": {"type": "number", "minimum": 0, "maximum": 10},
        "breaking_changes": {"type": "integer", "minimum": 0}
      }
    },
    "paradigm_shift": {
      "type": "object",
      "properties": {
        "score": {"type": "number", "minimum": 0, "maximum": 10},
        "classification": {
          "type": "string",
          "enum": ["Patch", "Incremental", "Architectural", "Revolutionary"]
        },
        "innovation_index": {"type": "number", "minimum": 0, "maximum": 10},
        "disruption_level": {"type": "string", "enum": ["Minimal", "Moderate", "Significant", "Transformative"]}
      }
    },
    "signature": {
      "type": "string",
      "pattern": "^0x[a-f0-9]+$",
      "description": "Cryptographic signature for delta integrity"
    }
  },
  "additionalProperties": false
}